<div class="spin show-spinner" *ngIf="loader == true"></div>

<div class="container">
    <div class="form-wrapper">
        <div class="heading-section ng-star-inserted">
            <div>Print Endorsement - ROP</div>
        </div>
        <mat-accordion class="search-accordian">
            <mat-expansion-panel [expanded]="true">
                <mat-expansion-panel-header>
                    <div class="heading-section">
                        Search Events
                    </div>
                </mat-expansion-panel-header>
                <div class=" form-datatable-list">
                    <form class="col-sm-12" [formGroup]="eventsForm">
                        <div class="row">
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput formControlName="authorizationFromDate"
                                        [matDatepicker]="authorizationFromDate" placeholder="Authorization From Date"
                                        [max]="dateNow" (dateChange)="onAuthFromSelect($event)" readonly>
                                    <mat-datepicker-toggle matSuffix [for]="authorizationFromDate">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #authorizationFromDate></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput formControlName="authorizationToDate"
                                        [matDatepicker]="authorizationToDate" placeholder="Authorization To Date"
                                        [min]="authToMin" [max]="dateNow" readonly>
                                    <mat-datepicker-toggle matSuffix [for]="authorizationToDate">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #authorizationToDate></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <mat-select formControlName="eventName" placeholder="ROP Type" #singleSelect1>
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="eventsNameCtrl"
                                                [placeholderLabel]="'Find Events Name...'"
                                                [noEntriesFoundLabel]="'no matching Events Name found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option
                                            *ngFor="let eventName of events_name_list | filterSelectInput: eventsNameCtrl.value :'lookupInfoName'"
                                            [value]="eventName.lookupInfoId">
                                            {{eventName.lookupInfoName}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput numbersOnly maxlength="10" placeholder="Employee Number"
                                        formControlName="empNo">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput type="text" formControlName="empName" alphabetInBtwSpaceOnly
                                        maxlength="50" placeholder="Employee Name">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <mat-select formControlName="designationId" placeholder="Designation">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="designationCtrl"
                                                [placeholderLabel]="'Find Designation...'"
                                                [noEntriesFoundLabel]="'No Matching Designation found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option
                                            *ngFor="let DG of designation_list | filterSelectInput:designationCtrl.value: 'name'"
                                            [value]="DG.id">
                                            {{DG.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput type="text" placeholder="PAN" maxlength="10" autocomplete="off"
                                        formControlName="panNo">
                                    <div class="error-wrapper"
                                        *ngIf="eventsForm.controls.panNo.touched && eventsForm.controls.panNo.errors">
                                        <mat-error *ngIf="eventsForm.controls.panNo.errors.invalidPanNo">
                                            Please enter valid PAN no. !
                                        </mat-error>
                                    </div>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <mat-label>District</mat-label>
                                    <mat-select formControlName="districtId">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="districtCtrl"
                                                [placeholderLabel]="'Find District...'"
                                                [noEntriesFoundLabel]="'No Matching Distri  ct found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option
                                            *ngFor="let ET of district_list | filterSelectInput:districtCtrl.value:'name'"
                                            [value]="ET.id">
                                            {{ET.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput numbersOnly maxlength="4" placeholder="Cardex Number"
                                        autocomplete="off" formControlName="cardexNo">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput numbersOnly maxlength="4" placeholder="DDO Number"
                                        autocomplete="off" formControlName="ddoCode">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput placeholder="Retirement Date" formControlName="retirementDate"
                                        [matDatepicker]="retirementDate" readonly>
                                    <mat-datepicker-toggle matSuffix [for]="retirementDate"></mat-datepicker-toggle>
                                    <mat-datepicker #retirementDate></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput type="text" maxlength="14" numbersOnly placeholder="Case No." autocomplete="off" formControlName="caseNo">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <mat-label>Class </mat-label>
                                    <mat-select formControlName="classId">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="classCtrl"
                                                [placeholderLabel]="'Find Class...'"
                                                [noEntriesFoundLabel]="'No Matching Class found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option
                                            *ngFor="let PR of class_list | filterSelectInput: classCtrl.value : 'lookupInfoName'"
                                            [value]="PR.lookupInfoId">
                                            {{PR.lookupInfoName}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <mat-select formControlName="employeeTypeId" placeholder="Employee Type">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="empTypeCtrl"
                                                [placeholderLabel]="'Find Class...'"
                                                [noEntriesFoundLabel]="'No Matching Class found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option
                                            *ngFor="let ET of emp_type_list | filterSelectInput:empTypeCtrl.value: 'lookupInfoName'"
                                            [value]="ET.lookupInfoId">
                                            {{ET.lookupInfoName}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput formControlName="inwardFromDate" [matDatepicker]="inwardFromDate"
                                        placeholder="Inward From Date" [max]="dateNow"
                                        (dateChange)="onInwardFromSelect($event)" readonly>
                                    <mat-datepicker-toggle matSuffix [for]="inwardFromDate">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #inwardFromDate></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <input matInput formControlName="inwardToDate" [matDatepicker]="inwardToDate"
                                        placeholder="Inward To Date" [min]="inwardToMin" [max]="dateNow" readonly
                                        [disabled]="fc.inwardFromDate.value === '' || fc.inwardFromDate.value === null">
                                    <mat-datepicker-toggle matSuffix [for]="inwardToDate">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #inwardToDate></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field class="full-width">
                                    <input matInput placeholder="Reference No." maxlength="24" formControlName="transNo"
                                        alphaNumericWithSlashHyphenOnly>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3">
                                <mat-form-field>
                                    <mat-select formControlName="printStatus" placeholder="Print Status">
                                        <mat-option>
                                            <ngx-mat-select-search [formControl]="printStatusCtrl"
                                                [placeholderLabel]="'Find Print Status...'"
                                                [noEntriesFoundLabel]="'No Matching Print Status found'">
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option
                                            *ngFor="let ET of printStatus_list | filterSelectInput:printStatusCtrl.value: 'lookupInfoName'"
                                            [value]="ET.lookupInfoId">
                                            {{ET.lookupInfoName}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="form-action-button">
                    <button mat-raised-button (click)="onSubmitSearch()" color="primary">
                        <i class="material-icons" aria-hidden="true" title="search">search</i>
                        Search
                    </button>
                    <button type="reset" mat-raised-button color="accent" (click)="clearForm();">
                        <i class="material-icons" aria-hidden="true" title="restore">
                            restore
                        </i>
                        Reset
                    </button>
                </div>
            </mat-expansion-panel>
        </mat-accordion>
        <div class="mat-elevation-z8 table-responsive mt-2 table-setting-to-avoid-word-break">
            <table mat-table [dataSource]="dataSource" style="width: 100%;" aria-describedby="pvuRegistry">

                <ng-container matColumnDef="isSelected">
                    <th mat-header-cell *matHeaderCellDef scope="row">
                        <mat-checkbox [checked]="checked && isAllSelected()"
                            [indeterminate]="intermediate && !isAllSelected() && !isNothingIsSelected()"
                            (change)="selectAll($event)" title="Select All">
                        </mat-checkbox>
                    </th>
                    <td mat-cell *matCellDef="let element;" class="centerAlign">
                        <mat-checkbox [value]="element.isSelected" [checked]="element.isSelected" title="Select"
                            (change)="checkboxValueChange($event, element)" *ngIf="element.isPrint === 1">
                        </mat-checkbox>
                    </td>
                </ng-container>

                <ng-container matColumnDef="position">
                    <th mat-header-cell *matHeaderCellDef scope="row">Sr. No.</th>
                    <td mat-cell *matCellDef="let element; let i = index;">
                        {{ (iteratablePageIndex * pageSize) + i + 1 }}
                    </td>
                    <!-- <td mat-footer-cell *matFooterCellDef [attr.colspan]="15" class="centerAlign">
                        <span *ngIf="dataSource && dataSource.data && dataSource.data.length == 0">
                            No Records Found!
                        </span>
                    </td> -->
                </ng-container>
                <ng-container matColumnDef="transNo">
                    <th mat-header-cell *matHeaderCellDef scope="row">Reference No.</th>
                    <td mat-cell *matCellDef="let element"> {{element.transNo}} </td>
                    <td mat-footer-cell *matFooterCellDef>
                        Total</td>
                </ng-container>
                <ng-container matColumnDef="inwardDate">
                    <th mat-header-cell *matHeaderCellDef scope="row">Inward Date</th>
                    <td mat-cell *matCellDef="let element">
                        <span
                            *ngIf="element.inwardDate && element.inwardDate != '-'">{{element.inwardDate | date : 'dd-MMM-yyyy hh:mm:ss a'}}</span>
                    </td>
                </ng-container>
                <ng-container matColumnDef="inwardNumber">
                    <th mat-header-cell *matHeaderCellDef scope="row">Inward Number</th>
                    <td mat-cell *matCellDef="let element">
                        {{element.inwardNumber}}
                    </td>
                </ng-container>
                <ng-container matColumnDef="eventName">
                    <th mat-header-cell *matHeaderCellDef scope="row">ROP Type</th>
                    <td mat-cell *matCellDef="let element"> {{element.eventName}} </td>
                </ng-container>
                <ng-container matColumnDef="employeeNo">
                    <th mat-header-cell *matHeaderCellDef scope="row">Employee Number</th>
                    <td mat-cell *matCellDef="let element">{{element.employeeNo}}</td>
                </ng-container>
                <ng-container matColumnDef="employeeName">
                    <th mat-header-cell *matHeaderCellDef scope="row">Employee Name</th>
                    <td mat-cell *matCellDef="let element"> {{element.employeeName}} </td>
                </ng-container>
                <ng-container matColumnDef="designation">
                    <th mat-header-cell *matHeaderCellDef scope="row">Designation</th>
                    <td mat-cell *matCellDef="let element"> {{element.designation}} </td>
                </ng-container>
                <ng-container matColumnDef="retirementDate">
                    <th mat-header-cell *matHeaderCellDef scope="row">Retirement Date</th>
                    <td mat-cell *matCellDef="let element"> {{element.retirementDate | date : 'dd-MMM-yyyy'}} </td>
                </ng-container>
                <ng-container matColumnDef="authorizationDate">
                    <th mat-header-cell *matHeaderCellDef scope="row">Authorization Date</th>
                    <td mat-cell *matCellDef="let element"> {{ element.authorizationDate | date : 'dd-MMM-yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="officeName">
                    <th mat-header-cell *matHeaderCellDef scope="row">Office Name</th>
                    <td mat-cell *matCellDef="let element"> {{element.officeName}} </td>
                </ng-container>
                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef scope="row">Status</th>
                    <td mat-cell *matCellDef="let element"> {{element.status}} </td>
                </ng-container>
                <ng-container matColumnDef="wfStatus">
                    <th mat-header-cell *matHeaderCellDef scope="row">Workflow Status</th>
                    <td mat-cell *matCellDef="let element"> {{element.wfStatus}} </td>
                </ng-container>
                <ng-container matColumnDef="printCnt">
                    <th mat-header-cell *matHeaderCellDef scope="row">Print Count</th>
                    <td mat-cell *matCellDef="let element">
                        <span *ngIf="element.printCnt > 0">{{element.printCnt}}</span>
                    </td>
                </ng-container>
                <ng-container matColumnDef="noData">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length" class="centerAlign">No Records Found!</td>
                </ng-container>
                <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef scope="row">Action
                    </th>
                    <td mat-cell *matCellDef="let element;let i=index" class="action-btn-i centerAlign">
                        <i class="material-icons plus delete" aria-hidden="true" (click)="onPrint(element)"
                            *ngIf="element.isPrint === 1">
                            print
                        </i>
                        <i *ngIf="element.printCnt > 1" class="material-icons plus history"
                            (click)="viewRePrintHistory(element)" title="View Reprint Comments"
                            aria-hidden="true">history</i>
                    </td>
                    <td mat-footer-cell *matFooterCellDef class="rightAlign"> </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; let i = index; columns: variableClm.value"></tr>
                <!-- <tr mat-footer-row
                    [class.hide-table-footer]="dataSource && dataSource.data && dataSource.data.length != 0"
                    *matFooterRowDef="displayedColumnsFooter"></tr> -->
            </table>
            <mat-paginator #paginator [pageSize]="pageSize" (page)="pageEvent = $event; onPaginateChange($event)" [length]="totalRecords" showFirstLastButtons></mat-paginator>
            <div class="form-action-button">
                <button type="button" mat-raised-button class="print-btn" title="Print" (click)="onMultiplePrint()">
                    <i class="material-icons" title="Print" aria-hidden="true">
                        print
                    </i>
                    Print
                </button>
                <button type="button" mat-raised-button (click)="goToDashboard()" class="btnClose">
                    <i class="material-icons" title="PVU dashboard" aria-hidden="true" title="close"> close</i>Close
                </button>
            </div>
        </div>
    </div>
</div>